---
- name: Daemon-reload restic systemd
  ansible.builtin.systemd:
    daemon_reload: yes

- name: Enable restic(s) timer(s)
  ansible.builtin.systemd:
    name: "restic@{{ item.1.task }}.timer"
    enabled: yes
  loop: "{{ restic_res.results | selectattr('changed', 'equalto', true) | map(attribute='item') }}"
  loop_control:
    label: "restic@{{ item.1.task }}.timer"

- name: Start restic(s) timer(s)
  ansible.builtin.systemd:
    name: "restic@{{ item.1.task }}.timer"
    state: started
  loop: "{{ restic_res.results | selectattr('changed', 'equalto', true) | map(attribute='item') }}"
  loop_control:
    label: "restic@{{ item.1.task }}.timer"