---
syncthing_image: "{{ host_syncthing_image | default('quay.io/linuxserver.io/syncthing') }}"
syncthing_image_version: "{{ host_syncthing_image_version | default('1.20.1') }}"
# https://quay.io/repository/linuxserver.io/syncthing?tag=latest&tab=tags

syncthing_config: "{{ http_services | selectattr('service', 'equalto', 'syncthing') | first }}"
syncthing_ports:
  - "{% if syncthing_config.direct_access %}[::]:{{ syncthing_config.backends[0].port }}{% else %}127.0.0.1:{{ syncthing_config.backends[0].port }}{% endif %}:8384/tcp"
  - "{% if syncthing_config.direct_access %}[::]:{{ syncthing_config.backends[0].port }}{% else %}[::1]:{{ syncthing_config.backends[0].port }}{% endif %}:8384/tcp"
  - "22000:22000/tcp"
  - "22000:22000/udp"
  - "21027:21027/udp"

syncthing_directories:
  - "{{ host_podman_volumes_path }}/syncthing"
  - "{{ host_podman_volumes_path }}/syncthing/config"
  - "{{ host_podman_volumes_path }}/syncthing/data"

syncthing_volumes_default:
  - "{{ host_podman_volumes_path }}/syncthing/config:/config"
  - "{{ host_podman_volumes_path }}/syncthing/data:/data"
syncthing_volumes: "{{ host_podman_syncthing_volumes | default(syncthing_volumes_default) }}"

# firewalld
firewalld_zone: "{{ host_firewalld_zone | default('home') }}"
syncthing_firewalld_ports:
  webui: "{{ syncthing_config.backends[0].port }}/tcp"
  p2p_tcp: "22000/tcp"
  p2p_udp: "22000/udp"
  discovery: "21027/udp"
syncthing_use_rich_firewalld_rules: "{{ host_syncthing_use_rich_firewalld_rules | default(false) }}"
syncthing_firewalld_rich_rules: "{{ host_syncthing_firewalld_rich_rules }}"