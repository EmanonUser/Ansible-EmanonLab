---
adguard_image: "{{ host_adguard_image | default('docker.io/adguard/adguardhome') }}"
adguard_image_version: "{{ host_adguard_image_version | default('v0.107.11') }}"
# https://hub.docker.com/r/adguard/adguardhome/tags

adguard_config: "{{ http_services | selectattr('service', 'equalto', 'adguard') | first }}"
adguard_ports:
  - "{% if adguard_config.direct_access %}[::]:{{ adguard_config.backends[0].port }}{% else %}127.0.0.1:{{ adguard_config.backends[0].port }}{% endif %}:3000/tcp"
  - "{% if adguard_config.direct_access %}[::]:{{ adguard_config.backends[0].port }}{% else %}[::1]:{{ adguard_config.backends[0].port }}{% endif %}:3000/tcp"
  - "{{ grp_dns_server_upstream_port }}:53/udp"
  - "{{ grp_dns_server_upstream_port }}:53/tcp"

adguard_directories:
  - "{{ host_podman_volumes_path }}/adguard/work"
  - "{{ host_podman_volumes_path }}/adguard/conf"
adguard_default_volumes:
  - "{{ host_podman_volumes_path }}/adguard/work:/opt/adguardhome/work"
  - "{{ host_podman_volumes_path }}/adguard/conf:/opt/adguardhome/conf"
adguard_volumes: "{{ host_adguard_default_volumes | default(adguard_default_volumes) }}"
adguard_network: "{% if adguard_config.public %}slirp4netns:outbound_addr={{ dmz_interface }}{% else %}slirp4netns{% endif %}"

# Firewalld
firewalld_zone: "{{ host_firewalld_zone | default('home') }}"
adguard_firewalld_ports:
  webui: "{{ adguard_config.backends[0].port }}/tcp"
  dns_udp: "{{ grp_dns_server_upstream_port }}/udp"
  dns_tcp: "{{ grp_dns_server_upstream_port }}/tcp"
adguard_use_rich_firewalld_rules: "{{ host_adguard_use_rich_firewalld_rules | default(false) }}"
adguard_firewalld_rich_rules: "{{ host_adguard_firewalld_rich_rules }}"