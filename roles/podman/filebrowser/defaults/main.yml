---
filebrowser_image: "{{ host_filebrowser_image | default('docker.io/filebrowser/filebrowser') }}"
filebrowser_image_version: "{{ host_filebrowser_image_version | default('v2-s6') }}"
# https://hub.docker.com/r/filebrowser/filebrowser/tags

filebrowser_config: "{{ http_services | selectattr('service', 'equalto', 'filebrowser') | first }}"
filebrowser_ports:
  - "{% if filebrowser_config.direct_access %}[::]{{ filebrowser_config.backends[0].port }}
    {% else %}127.0.0.1:{{ filebrowser_config.backends[0].port }}{% endif %}:2500/tcp"
  - "{% if filebrowser_config.direct_access %}[::]:{{ filebrowser_config.backends[0].port }}
    {% else %}[::1]:{{ filebrowser_config.backends[0].port }}{% endif %}:2500/tcp"

filebrowser_directories:
  - "{{ podman_volumes_path }}/filebrowser"
  - "{{ podman_volumes_path }}/filebrowser/data"
  - "{{ podman_volumes_path }}/filebrowser/config"
  - "{{ podman_volumes_path }}/filebrowser/database"

filebrowser_files:
  config: "{{ podman_volumes_path }}/filebrowser/config/settings.json"
  database: "{{ podman_volumes_path }}/filebrowser/database/database.db"

filebrowser_volumes: "{{ host_filebrowser_volumes | default(filebrowser_default_volumes) }}"
filebrowser_default_volumes:
  - "{{ podman_volumes_path }}/filebrowser/config/settings.json:/config/settings.json"
  - "{{ podman_volumes_path }}/filebrowser/database/database.db:/database/database.db"
  - "{{ podman_volumes_path }}/filebrowser/data:/srv"
filebrowser_network: "{% if filebrowser_config.public %}slirp4netns:outbound_addr={{ dmz_interface }}{% else %}slirp4netns{% endif %}"

# Firewalld
firewalld_zone: "{{ host_firewalld_zone | default('home') }}"
filebrowser_firewalld_ports: "{{ filebrowser_config.backends[0].port }}/tcp"
filebrowser_use_rich_firewalld_rules: "{{ host_filebrowser_use_rich_firewalld_rules | default(false) }}"
filebrowser_firewalld_rich_rules: "{{ host_filebrowser_firewalld_rich_rules }}"
