---
syncthing_image: "{{ host_syncthing_image | default('quay.io/linuxserver.io/syncthing') }}"
syncthing_image_version: "{{ host_syncthing_image_version | default('latest') }}"
# https://quay.io/repository/linuxserver.io/syncthing?tag=latest&tab=tags

syncthing_config: "{{ http_services | selectattr('service', 'equalto', 'syncthing') | first }}"
syncthing_ports:
  - "{% if syncthing_config.direct_access %}[::]:{{ syncthing_config.port }}
    {% else %}127.0.0.1:{{ syncthing_config.port }}{% endif %}:8384/tcp"
  - "{% if syncthing_config.direct_access %}[::]:{{ syncthing_config.port }}
    {% else %}[::1]:{{ syncthing_config.port }}{% endif %}:8384/tcp"
  - "22000:22000/tcp"
  - "22000:22000/udp"
  - "21027:21027/udp"

syncthing_directories:
  - "{{ podman_volumes_path }}/syncthing"
  - "{{ podman_volumes_path }}/syncthing/config"
  - "{{ podman_volumes_path }}/syncthing/data"
syncthing_default_volumes:
  - "{{ podman_volumes_path }}/syncthing/config:/config"
  - "{{ podman_volumes_path }}/syncthing/data:/data"
syncthing_volumes: "{{ host_syncthing_volumes | default(syncthing_default_volumes) }}"
syncthing_network: "{% if not syncthing_config.internal %}slirp4netns:outbound_addr={{ dmz_interface }}{% else %}slirp4netns{% endif %}"

# Firewalld
firewalld_zone: "{{ host_firewalld_zone | default('home') }}"
syncthing_firewalld_ports:
  webui: "{{ syncthing_config.port }}/tcp"
  p2p_tcp: "22000/tcp"
  p2p_udp: "22000/udp"
  discovery: "21027/udp"
syncthing_use_rich_firewalld_rules: "{{ host_syncthing_use_rich_firewalld_rules | default(false) }}"
syncthing_firewalld_rich_rules: "{{ host_syncthing_firewalld_rich_rules }}"
