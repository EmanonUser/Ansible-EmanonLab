---
grafana_image: "{{ host_grafana_image | default('docker.io/grafana/grafana') }}"
grafana_image_version: "{{ host_grafana_image_version | default('latest') }}"
# https://hub.docker.com/r/grafana/grafana/tags

grafana_config: "{{ http_services | selectattr('service', 'equalto', 'grafana') | first }}"
grafana_ports:
  - "{% if grafana_config.direct_access %}[::]:{{ grafana_config.backends[0].port }}{% else %}127.0.0.1:{{ grafana_config.backends[0].port }}{% endif %}:3000/tcp"
  - "{% if grafana_config.direct_access %}[::]:{{ grafana_config.backends[0].port }}{% else %}[::1]:{{ grafana_config.backends[0].port }}{% endif %}:3000/tcp"

grafana_directories:
  - "{{ host_podman_volumes_path }}/grafana/storage"
  - "{{ host_podman_volumes_path }}/grafana/dashboards"
grafana_default_volumes: "{{ host_podman_volumes_path }}/grafana/storage:/var/lib/grafana"
grafana_volumes: "{{ host_grafana_volumes | default(grafana_default_volumes) }}"
grafana_network: "{% if grafana_config.public %}slirp4netns:outbound_addr={{ dmz_interface }}{% else %}slirp4netns{% endif %}"

# Firewalld
firewalld_zone: "{{ host_firewalld_zone | default('home') }}"
grafana_firewalld_ports: "{{ grafana_config.backends[0].port }}/tcp"
grafana_use_rich_firewalld_rules: "{{ host_grafana_use_rich_firewalld_rules | default(false) }}"
grafana_firewalld_rich_rules: "{{ host_grafana_firewalld_rich_rules }}"