---
- name: Import filebrowser base config
  ansible.builtin.copy:
    src: filebrowser.json
    dest: "{{ filebrowser_volumes[0] }}"
    owner: "{{ primary_user_username }}"
    group: "{{ primary_user_username }}"
    mode: u=rw,g=,o=
    force: no

- name: Create filebrowser empty database
  ansible.builtin.copy:
    content: ""
    dest: "{{ filebrowser_volumes[1] }}"
    owner: "{{ primary_user_username }}"
    group: "{{ primary_user_username }}"
    mode: u=rw,g=,o=
    force: no

- name: Run filebrowser docker container
  community.docker.docker_container:
    name: filebrowser
    image: filebrowser/filebrowser
    user: 1000:1000
    ports: "{{ filebrowser_ports }}"
    volumes: "{{ filebrowser_volumes }}"
    restart_policy: unless-stopped
    state: started
    container_default_behavior: no_defaults