(snip) {
    bind 127.0.0.1 ::1
    bind igb1
    any
    minimal
    log
    cache 300
    errors {
        consolidate 120s ".* i/o timeout$"
        consolidate 30s "^Failed to .+"
    }
}

home.emanon.dev.:53 {
    import snip
    file /usr/local/etc/coredns/master.db
}

home.arpa.:53 {
    import snip
    file /usr/local/etc/coredns/master.db
}

.:53 {
    import snip
    forward . [::1]:5301 [::1]:5302 [::1]:5303 {
        policy sequential
        except example.org
        except in-addr.arpa
        health_check 5s
    }
}

.:5301 {
    bind ::1
    forward . tls://9.9.9.9 tls://149.112.112.112 tls://2620:fe::fe tls://2620:fe::9 {
        tls_servername dns.quad9.net
        health_check 5s
    }
    cache 30
}

.:5302 {
    bind ::1
    forward . tls://1.1.1.1 tls://1.0.0.1 tls://2606:4700:4700::1111 tls://2606:4700:4700::1001 {
        tls_servername cloudflare-dns.com
        health_check 5s
    }
    cache 30
}

.:5303 {
    bind ::1
    forward . tls://8.8.8.8 tls://8.8.4.4 tls://2001:4860:4860::8888 tls://2001:4860:4860::8844 {
        tls_servername dns.google
        health_check 5s
    }
    cache 30
}
