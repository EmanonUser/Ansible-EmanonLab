---
prometheus_image: "{{ host_prometheus_image | default('docker.io/prom/prometheus') }}"
prometheus_image_version: "{{ host_prometheus_image_version | default('latest') }}"
# https://hub.docker.com/r/prom/prometheus/tags

prometheus_config: "{{ http_services | selectattr('service', 'equalto', 'prometheus') | first }}"
prometheus_ports:
  - "{% if prometheus_config.direct_access %}[::]:{{ prometheus_config.port }}
    {% else %}127.0.0.1:{{ prometheus_config.port }}{% endif %}:9090/tcp"
  - "{% if prometheus_config.direct_access %}[::]:{{ prometheus_config.port }}
    {% else %}[::1]:{{ prometheus_config.port }}{% endif %}:9090/tcp"

prometheus_directories:
  - "{{ podman_volumes_path }}/prometheus"
  - "{{ podman_volumes_path }}/prometheus/data"
prometheus_default_volumes:
  - "{{ podman_volumes_path }}/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml"
  - "{{ podman_volumes_path }}/prometheus:/etc/prometheus"
prometheus_volumes: "{{ host_prometheus_volumes | default(prometheus_default_volumes) }}"
prometheus_network: "{% if not prometheus_config.internal %}slirp4netns:outbound_addr={{ dmz_interface }}{% else %}slirp4netns{% endif %}"

prometheus_config_path: "{{ podman_volumes_path }}/prometheus/prometheus.yml"

# firewalld
firewalld_zone: "{{ host_firewalld_zone | default('home') }}"
prometheus_firewalld_ports: "{{ prometheus_config.port }}/tcp"
prometheus_use_rich_firewalld_rules: "{{ host_prometheus_use_rich_firewalld_rules | default(false) }}"
prometheus_firewalld_rich_rules: "{{ host_prometheus_firewalld_rich_rules }}"
